<!doctype html>
<html lang="en">
  <head>
  <title>
    Docker-Compose Sample Configs
    -
    ZM
  </title>
  <meta charset="utf-8">
  <meta http-equiv="content-language" content="en">
  <meta name="theme-color" content="#ffffff">
  <meta name="supported-color-schemes" content="light dark">
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="applicable-device" content="pc,mobile">
  <meta name="author" content="ZM">
  <meta name="darkreader-lock">
    <meta name="description" content="Docker-Compose Sample Configs">
    <meta
      name="keywords"
      content="ZM,Docker"
    >
  <link rel="icon" href="/static/img/favicon.ico">
  <link rel="apple-touch-icon" href="/static/img/logo.png">
  <link rel="stylesheet" href="/static/css/common.css?t=20230813023501">
  <link rel="stylesheet" href="/static/css/theme-dark.css?t=20230813023501">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"
    rel="stylesheet"
  >

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


    
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css">




    <link rel="stylesheet" href="/static/css/post.css?t=20230813023501">
    <link rel="stylesheet" href="/static/css/code-dark.css?t=20230813023501">
    <link rel="stylesheet" href="/static/css/code-light.css?t=20230813023501">

  <script>
    window.blog = {
      baseurl: '',
      buildAt: '20230813023501',
      darkMode: false,
      initDarkMode: function (flag) {
        if (flag && flag === 'true') this.darkMode = true;
        else if (flag && flag === 'false') this.darkMode = false;
        else this.darkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        document.documentElement.className = this.darkMode ? 'dark' : '';
        document
          .querySelector('meta[name=theme-color]')
          .setAttribute('content', this.darkMode ? '#2D2E32' : '#FFFFFF');
      },
    };
    blog.initDarkMode(localStorage.darkMode);
  </script>
</head>
<body>
    <div class="row">
      <div class="col1">
        <header class="header">
  <a href="https://www.zhoumike.com/notes/2021/12/22/docker-compose-samples.html">
    <span class="logo">Z.M.</span>
  </a>
  <nav class="menu">
    

      
      

      
        <a href="/notes.html"  class="hover-underline is-active-page">
          
            Notes
          
        </a>
      
    

      
      

      
    

      
      

      
    

      
      

      
        <a href="/search.html"  class="hover-underline ">
          
            <span class="material-icons menu-icon">search</span>
          
        </a>
      
    </nav>
</header>
<div class="page page-post">
          
          <div class="pretitle">
            
            
            <a href="/notes.html">
              <code class="language-plaintext">Notes</code>
            </a>
            <a
                href="/notes.html?category=Docker"
                class="category-link hover-underline"
              >Docker</a>
          </div>
          <h1 class="title" id="Docker-Compose Sample Configs">Docker-Compose Sample Configs</h1>
          <div class="subtitle">
            <span class="material-icons">calendar_month</span>
              <span>
                2021-12-22</span>
            
          </div>
          <div class="post"><h2 id="overview">Overview</h2>

<p>Sample Docker-Compose configurations. Tested on <code class="language-plaintext highlighter-rouge">Docker v 20.10.8</code> and <code class="language-plaintext highlighter-rouge">Docker-Compose v 1.29.1</code>.</p>

<h2 id="forward-aws-credentials">Forward AWS Credentials</h2>

<p>We can forward AWS credentials from host to the container, useful for VSCode devcontainers.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: <span class="s1">'3'</span>

services:

  devcontainer:
    container_name: ear-devcontainer
    init: <span class="nb">true
    </span>build:
      context: ..
      dockerfile: .devcontainer/Dockerfile
    env_file: .env
    volumes:
      - ..:/workspace:cached <span class="c"># VSCode workspace</span>
      - ~/.aws:/home/node/.aws:cached <span class="c"># AWS credentials</span>
      - /var/run/docker.sock:/var/run/docker-host.sock <span class="c"># host's Docker daemon</span>
    networks:
      - express_api_ref

networks:
  express_api_ref:
    name: express_api_ref
</code></pre></div></div>

<h2 id="mysql-57">MySQL 5.7</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: <span class="s1">'3'</span>

services:

  db:
    container_name: tf-api-db
    image: mysql:5.7
    <span class="c"># Default MySQL 5.7 character set and collation is latin1, but utf8 is recommended by MySQL themself.</span>
    <span class="c"># https://dev.mysql.com/doc/mysql-installation-excerpt/5.7/en/docker-mysql-more-topics.html</span>
    <span class="c"># https://stackoverflow.com/questions/2708958/differences-between-utf8-and-latin1</span>
    <span class="c"># https://stackoverflow.com/questions/30074492/what-is-the-difference-between-utf8mb4-and-utf8-charsets-in-mysql</span>
    <span class="nb">command</span>: mysqld <span class="nt">--default-authentication-plugin</span><span class="o">=</span>mysql_native_password <span class="nt">--character-set-server</span><span class="o">=</span>utf8mb4 <span class="nt">--collation-server</span><span class="o">=</span>utf8mb4_unicode_ci
    env_file: .env
    environment:
      MYSQL_RANDOM_ROOT_PASSWORD: 1
      MYSQL_DATABASE: <span class="nv">$TF_API_DB_NAME</span>
      MYSQL_USER: <span class="nv">$TF_API_DB_USER</span>
      MYSQL_PASSWORD: <span class="nv">$TF_API_DB_PASSWORD</span>
      MYSQL_TCP_PORT: <span class="nv">$TF_API_DB_PORT</span>
    ports:
      - <span class="s2">"</span><span class="nv">$TF_API_DB_PORT</span><span class="s2">:</span><span class="nv">$TF_API_DB_PORT</span><span class="s2">"</span>
</code></pre></div></div>
</div>
          
        </div>
        <footer class="footer">
  <span></span>
  <!--
    <a href="/static/xml/rss.xml">RSS订阅</a>
    <span>Theme By</span>
    <a href="https://github.com/TMaize/tmaize-blog">TMaize</a>
  -->
  <div class="footer-btn theme-toggler hide">
    <span class="material-icons">light_mode</span>
  </div>
  <div class="footer-btn to-top">
    <span class="material-icons">vertical_align_top</span>
  </div>
</footer>
</div>
      <div class="sidebar col2">
        <div class="toc-wrapper">
          <div class="toc-header">Contents</div>
          <nav id="toc"></nav>
        </div>
      </div>
    </div>
    <script type="text/javascript" src="/static/js/blog.js?t=20230813023501"></script>
<script type="text/javascript" src="/static/js/search.js?t=20230813023501"></script>

<script type="text/javascript">
    function toggleDrawIoFullScreen(divId) {
      const container = document.querySelector(`#${divId}`);
      if (container.classList.contains('drawio-full-screen')) {
        container.classList.remove('drawio-full-screen');
      } else {
        container.classList.add('drawio-full-screen');
      }
    }
  </script>

  


  <script
    type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.js"
  ></script>
  <script type="text/javascript">
    (function () {
      // see: https://github.com/tscanlin/tocbot#usage
      tocbot.init({
        tocSelector: '#toc',
        contentSelector: '.post',
        // ignoreSelector: "[data-toc-skip]",
        headingSelector: 'h2',
        orderedList: false,
        scrollSmooth: false,
      });
    })();
  </script>



</body>
</html>
